# Лабораторная работа №1: Применение дизассемблеров (выполнили: **Брусило Даниил, Рыжков Егор, Капустянский Олег, 21-К-АС2**)
**Дисциплина:** Защита программного обеспечения защищенных автоматизированных систем
**Цель:** Изучить основы статического анализа вредоносного ПО с помощью дизассемблера IDA Pro.

## 1. Подготовка к анализу

1.  Была подготовлена виртуальная машина с отключенным Windows Defender.
2.  С сайта vx-underground.org в разделе Samples был скачан образец вредоносного ПО под названием "GodFather".
3.  Файл был распакован на Рабочий стол виртуальной машины.
4.  Для анализа использовался дизассемблер IDA Pro 9.2.

![](/source/1.png)

## 2. Первоначальная загрузка файла в IDA Pro

![](/source/2.png)

1.  При открытии файла IDA Pro предложила выбрать тип файла. Исходя из длинного имени файла (хеш-SHA256), было решено открыть его как **Binary file** для последующего анализа как исполняемого файла Windows.
![](/source/3.png)
3.  В качестве процессора был выбран **Intel 64-bit (x86-64) processor**.
4.  После загрузки в окне IDA View-A отобразились только байты данных (инструкции `db`), а вкладки Imports (импорты) и Exports (экспорты) остались пустыми.
![](/source/6.png)
![](/source/7.png)
![](/source/8.png)
5.  Анализ свойств файла в системе показал:
    - Тип файла: "Файл" (File), что нестандартно для исполняемого файла.
    - Размер: 5.82 МБ, что довольно много.
    - Дата модификации: август 2023 года.
![](/source/5.png)
6.  На основании этих признаков (отсутствие понятного кода, пустые таблицы импорта, нестандартный тип) был сделан вывод о том, что файл, вероятно, упакован или обфусцирован для затруднения анализа.

## 3. Ключевое открытие: определение истинного формата файла

1.  Для проверки гипотезы об упаковке файл был повторно открыт в IDA Pro, но на этот раз был выбран режим просмотра как архив.
2.  IDA Pro отобразила внутреннюю структуру, показав, что файл является **ZIP-архивом**. Его содержимое включало файлы `AndroidManifest.xml`, `classes.dex`, папки `lib/` с библиотеками, имеющими расширение `.so`, и папку `res/` с ресурсами.
![](/source/9.png)
3.  **Вывод:** Анализируемый образец "GodFather" является не исполняемым файлом для Windows, а **пакетом приложения для операционной системы Android (APK-файлом)**. Это стало ключевым открытием, объяснившим предыдущие неудачи в дизассемблировании и определившим дальнейшее направление анализа.

## 4. Анализ Android-приложения в IDA Pro

1.  Было принято решение открыть в IDA Pro основной исполняемый компонент Android-приложения — файл **`classes.dex`** (Dalvik Executable).
2.  После его загрузки в окне **Exports** появился обширный список методов, что подтвердило успешность анализа формата. Было отмечено, что имена методов были подвергнуты сильной обфускации (например, `a0_clinit_@V`, `b0.k8277e09@LL`), что затрудняло понимание их назначения по названию.
![](/source/10.png)
3.  Для поиска конкретных признаков вредоносной активности было открыто окно **Strings** (строки). Среди множества технических и отладочных строк были выявлены ключевые элементы:
    - Обнаружены многочисленные строки, связанные с библиотекой **OkHttp** (например, `OkHttpClient`, `HttpUrl.Builder`). Наличие этой библиотеки указывает на реализацию в приложении развитого сетевого функционала для выполнения HTTP/HTTPS-запросов.
    - Также были найдены строки, свидетельствующие о работе с сетевыми протоколами, таймаутами и построением URL.
![](/source/11.png)
![](/source/12.png)
4.  **Вывод:** Анализ строк позволил установить, что вредоносное приложение обладает сложным сетевым модулем, использующим современные библиотеки для скрытого обмена данными с внешними серверами.

## 5. Интерпретация результатов и выводы

В ходе лабораторной работы был выполнен статический анализ предоставленного образца "GodFather" с помощью дизассемблера IDA Pro.

1.  **Идентификация формата:** В процессе исследования было установлено, что анализируемый файл является **вредоносным приложением для Android (APK)**, а не программой для Windows. Это определило дальнейшую методику анализа.
2.  **Признаки обфускации:** Код приложения подвергся сильной обфускации: имена методов и классов были заменены на бессмысленные последовательности символов, что является стандартным приемом для затруднения анализа.
3.  **Выявленная функциональность:** Несмотря на обфускацию, анализ строковых констант позволил обнаружить важнейший компонент — **сетевую библиотеку OkHttp**. Данный факт свидетельствует о том, что основная вредоносная активность приложения, вероятно, связана с коммуникацией по сети: скрытая передача данных на удаленные серверы, получение команд, загрузка дополнительных модулей.
4.  **Оценка угрозы:** Объединив результаты анализа (формат Android APK, наличие обфускации, развитый сетевой функционал), можно сделать вывод о том, что "GodFather" представляет собой **сложного мобильного троянца**. Его сетевая активность, скрытая за легитимной библиотекой, указывает на возможные функции по краже конфиденциальной информации (учетные данные, SMS, данные банковских приложений) с зараженного устройства и удаленному управлению им.

**Общий вывод:** Работа продемонстрировала важность корректной идентификации формата анализируемого файла и показала, что даже при сильной обфускации статический анализ строк и структур позволяет сделать значимые выводы о потенциальных возможностях вредоносной программы. Для полного раскрытия логики работы троянца требуются дальнейшие этапы анализа с применением специализированных для Android инструментов и методов динамического исследования.
